backend:
    name: git-gateway
    repo: allen-cell-animated/cell-catalog
    branch: main
    commit_messages:
        create: "Create {{collection}} “{{slug}}”"
        update: "Update {{collection}} “{{slug}}”"
        delete: "Delete {{collection}} “{{slug}}”"
        uploadMedia: "[skip ci] Upload “{{path}}”"
        deleteMedia: "[skip ci] Delete “{{path}}”"
    squash_merges: true

publish_mode: editorial_workflow
local_backend: true
media_folder: static/img
public_folder: /img

# Section below defines reusable field collections defined with 
# yaml anchors &[anchor], referenced with alias *[anchor]
richTextFields: &richTextFields
  - &f_text       { label: "Text", name: "text", widget: "string" }
  - &f_emphasis
    label: "emphasis"
    name: "emphasis"
    widget: "list"
    required: false
    fields: [ { label: "Text", name: "text", widget: "string" } ]
  - &f_link
    label: "URL"
    name: "link"
    widget: "list"
    required: false
    fields:
      - { label: "Text", name: "text", widget: "string" }
      - { label: "URL",  name: "url",  widget: "string" }

objects/richTextObject: &objects_richTextObject
  widget: "object"
  fields: *richTextFields

field/templateKey: &field_templateKey
  label: "Template Key"
  name: "templateKey"
  widget: "hidden"

field/date: &field_date
  label: "Publish Date"
  name: "date"
  widget: "datetime"

field/orderLink: &field_orderLink
  label: "Order Link"
  name: "order_link"
  widget: "string"
  required: false

field/certificate: &field_certificateOfAnalysis
  label: "Certificate of Analysis"
  name: "certificate_of_analysis"
  widget: "file"
  required: false

relation/gene: &relation_gene
  label: "Gene"
  name: "gene"
  widget: "relation"
  collection: "gene-name"
  search_fields: ["symbol", "name", "protein", "structure"]
  value_field: "symbol"
  display_fields: ["symbol"]

imageFields: &fields_image
  - { label: "Image", name: "image", widget: "image" }
  - { label: "Caption", name: "caption", widget: "string", required: false }

videoFields: &fields_video
  - { label: "Video", name: "video", widget: "file" }
  - { label: "Caption", name: "caption", widget: "string", required: false }

objects/imagesAndVideos: &objects_imagesAndVideos
  widget: "object"
  required: false
  fields:
    - label: "Images"
      name: "images"
      widget: "list"
      required: false
      hint: "The first image will be used as the thumbnail in the catalog. Drag to rearrange the order."
      fields: *fields_image
    - label: "Videos"
      name: "videos"
      widget: "list"
      required: false
      fields: *fields_video

acknowledgementsBlock: &acknowledgementsBlock
  widget: "object"
  fields:
    - { label: "Intro", name: "intro", widget: "string" }
    - label: "Contributors"
      name: "contributors"
      widget: "list"
      required: false
      collapsed: true
      fields:
        - { label: "Name", name: "name", widget: "string" }
        - { label: "Institution", name: "institution", widget: "string" }
    - { label: "Outro", name: "outro", widget: "string" }

diagramFields: &diagramFields
  - { label: "Title", name: "title", widget: "string", required: false }
  - { label: "Image", name: "image", widget: "image" }
  - { label: "Caption", name: "caption", widget: "string", required: false }

cellLineStatusOptions: &cellLineStatusOptions
  - { label: "Data is complete: will render on the table and the subpage", value: "data complete" }
  - { label: "Released: renders only on the table", value: "released" }
  - { label: "In progress: will show in the 'in progress' table", value: "in progress" }
  - { label: "Hide: you can enter data but it won't show up on the site at all", value: "hide" }

options/alleleCount: &options_alleleCount [ "mono", "bi" ]
options/tagLocation: &options_tagLocation [ "C-terminus", "N-terminus", "NA" ]
options/fluorescentTag: &options_fluorescentTag [ "mEGFP", "EGFP", "mTagRFP-T", "TagBFP", "HaloTag" ]
options/protocolCategory: &options_protocolCategory
  [ "Cell Culture Protocols", "Gene Editing Protocols", "Disease Specific Protocols" ]

collections:
    - name: "cell-line"
      label: "Cell Lines"
      label_singular: "Cell Line"
      folder: "src/pages/cell-line"
      create: true
      slug: "AICS-{{cell_line_id}}-{{clone_number}}"
      path: "{{slug}}/index"
      identifier_field: "cell_line_id"
      summary: "AICS-{{cell_line_id}}-{{clone_number}}-{{genetic_modifications.[0].gene}}"
      media_folder: ""
      public_folder: ""
      fields:
          - <<: *field_templateKey
            default: "cell-line"
          - {
                label: "ID",
                name: "cell_line_id",
                widget: "number",
                required: true,
            }
          - <<: *field_date
          - { label: "name", name: "name", widget: "string", required: false }
          - {
                label: "Status",
                name: "status",
                widget: "select",
                options: *cellLineStatusOptions,
                default: "hide",
                required: true,
            }
          - {
                label: "Clone Number",
                name: "clone_number",
                widget: "number",
                value_type: int,
                required: false,
            }
          - {
                label: "Parent line ID (leave as 0 for 'WTC')",
                name: "parental_line",
                widget: "number",
                default: 0,
                required: true,
            }
          - {
                label: "Genetic Modifications",
                name: "genetic_modifications",
                widget: "list",
                required: false,
                fields: [
                { <<: *relation_gene, required: false },
                { label: "Allele Count", name: "allele_count", widget: "select", options: *options_alleleCount, required: false },
                { label: "Tag Location", name: "tag_location", widget: "select", options: *options_tagLocation, required: false },
                { label: "Fluorescent Tag", name: "fluorescent_tag", widget: "select", options: *options_fluorescentTag, required: false }
                ]
            }
          - <<: *field_orderLink
          - <<: *field_certificateOfAnalysis
          - {
                label: "Donor Plasmid",
                name: "donor_plasmid",
                widget: "string",
                required: false,
            }
          - {
                label: "hPSCreg Certificate",
                name: "hPSCreg_certificate_link",
                widget: "file",
                required: false,
            }
          - label: "Image and Video Carousel"
            name: "images_and_videos"
            <<: *objects_imagesAndVideos
          - {
                label: "Editing Design",
                name: "editing_design",
                widget: "object",
                required: false,
                collapsed: true,
                fields:
                    [
                        {
                            # TODO: confirm with the team what data we need for this field. I'll leave it as it is for now.
                            label: "NCBI Isoform(s)",
                            name: "ncbi_isoforms",
                            widget: "string",
                            required: false,
                            hint: "Use / to separate multiple isoforms (e.g., NM_002859 / NM_001080855)"
                        },
                        {
                            label: "crRNA",
                            name: "cr_rna",
                            widget: "string",
                            required: false,
                        },
                        {
                            label: "Linker",
                            name: "linker",
                            widget: "string",
                            required: false,
                        },
                        {
                            label: "Cas9",
                            name: "cas9",
                            widget: "select",
                            default: "",
                            options: ["", "Wildtype spCas9", "TrueCut™ Cas9 Protein"],
                            required: false,
                        },
                        {
                            label: "Diagrams",
                            name: "diagrams",
                            widget: "list",
                            required: false,
                            fields: *diagramFields
                        },
                    ],
            }
          - {
                label: "Cell Line Category",
                name: "cell_line_category",
                widget: "select",
                options:
                    ["Key Structure and Organelle", "Nuclear Structure", "Stress", "Cardiac Structure", "Tools", "Endothelial"],
                required: false,
            }
    - name: "disease-cell-line"
      label: "Disease Cell Lines"
      label_singular: "Disease Cell Line"
      folder: "src/pages/disease-cell-line"
      create: true
      slug: "AICS-{{cell_line_id}}"
      path: "{{slug}}/index"
      identifier_field: "cell_line_id"
      summary: "AICS-{{cell_line_id}} - {{disease}}"
      media_folder: ""
      public_folder: ""
      fields:
          - <<: *field_templateKey
            default: "disease-cell-line"
          - <<: *field_date
          - {
                label: "ID",
                name: "cell_line_id",
                widget: "number",
                required: true,
            }
          - {
                label: "Disease",
                name: "disease",
                widget: "relation",
                collection: "disease",
                search_fields: ["name"],
                value_field: "name",
            },
          - { label: "SNP", name: "snp", widget: string }
          - {
                label: "Parent line",
                name: "parental_line",
                widget: "relation",
                collection: "cell-line",
                search_fields: ["cell_line_id"],
                value_field: "cell_line_id",
            }
          - {
                label: "Status",
                name: "status",
                widget: "select",
                options: *cellLineStatusOptions,
                default: "in progress",
                required: true,
            }
          - {
                label: "Clones",
                name: "clones",
                widget: list,
                fields:
                    [
                        {
                            label: "Clone number",
                            name: "clone_number",
                            widget: "number",
                        },
                        {
                            label: "Clone Type",
                            name: "type",
                            widget: "select",
                            options: ["Mutant", "Control"],
                        },
                        {
                            label: "Transfection Replicate",
                            name: "transfection_replicate",
                            widget: "string",
                            required: false,
                        },
                        {
                            label: "Genotype",
                            name: "genotype",
                            widget: "string",
                            required: false,
                        },
                        {
                            label: "Troponin T, % Positive Cells(n)",
                            name: "positive_cells",
                            widget: "number",
                            value_type: "float",
                            required: false,
                        },
                        {
                            label: "Passing Antibodies",
                            name: "antibody_analysis",
                            hint: "select all antibodies this clone passed ",
                            widget: "select",
                            options: ["PAX6", "SOX17", "Brachyury"],
                            multiple: true,
                            required: false,
                        },
                        {
                            label: "Differentiation",
                            name: "differentiation",
                            widget: "list",
                            required: false,
                            fields:
                                [
                                    {
                                        label: "NANOG",
                                        name: "NANOG",
                                        widget: "number",
                                        value_type: "float",
                                        required: false,
                                    },
                                    {
                                        label: "SOX2",
                                        name: "SOX2",
                                        widget: "number",
                                        value_type: "float",
                                        required: false,
                                    },
                                    {
                                        label: "OCT4",
                                        name: "OCT4",
                                        widget: "number",
                                        value_type: "float",
                                        required: false,
                                    },
                                    {
                                        label: "SSEA-1",
                                        name: "SSEA-1",
                                        widget: "number",
                                        value_type: "float",
                                        required: false,
                                    },
                                    {
                                        label: "SSEA-4",
                                        name: "SSEA-4",
                                        widget: "number",
                                        value_type: "float",
                                        required: false,
                                    },
                                ],
                        },
                    ],
            }
          - <<: *field_orderLink
          - <<: *field_certificateOfAnalysis
          - {
                label: "hPSCreg Certificate",
                name: "hPSCreg_certificate_link",
                widget: "file",
                required: false,
            }
          - label: "Image and Video Carousel",
            name: "images_and_videos",
            <<: *objects_imagesAndVideos
          - {
                label: "Genomic Characterization",
                name: "genomic_characterization",
                widget: "object",
                required: false,
                collapsed: true,
                fields:
                    [
                        {
                            label: "Diagrams",
                            name: "diagrams",
                            widget: "list",
                            required: false,
                            collapsed: true,
                            fields: *diagramFields
                        },
                    ],
            }
          - {
                label: "Editing Design",
                name: "editing_design",
                widget: "object",
                required: false,
                collapsed: true,
                fields:
                    [
                        {
                            label: "crRNA Target Site",
                            name: "cr_rna_target_site",
                            widget: "string",
                            required: false,
                            hint: "Enter entire crRNA Target Site sequence. Place square brackets around PAM site. e.g. AG[TGG]ATA",
                        },
                        {
                            label: "DNA Donor Sequence",
                            name: "dna_donor_sequence",
                            widget: "list",
                            required: false,
                            collapsed: true,
                            hint: "Enter entire DNA donor sequence. Place square brackets around mutation sites. e.g. AG[A]AA",
                            fields:
                                [
                                    {
                                        label: "Sequence",
                                        name: "sequence",
                                        widget: "string",
                                    },
                                    {
                                        label: "Type",
                                        name: "type",
                                        widget: "select",
                                        required: false,
                                        default: "",
                                        options: ["", "WT", "Mutant"],
                                    },
                                ],
                        },
                        {
                            label: "Cas9",
                            name: "cas9",
                            widget: "string",
                            required: false,
                        },
                        {
                            label: "F Primer for PCR/Sequencing",
                            name: "f_primer",
                            widget: "string",
                            required: false,
                        },
                        {
                            label: "R primer for PCR/Sequencing",
                            name: "r_primer",
                            widget: "string",
                            required: false,
                        },
                        {
                            label: "Diagrams",
                            name: "diagrams",
                            widget: "list",
                            required: false,
                            collapsed: true,
                            fields:
                                [
                                    {
                                        label: "Title",
                                        name: "title",
                                        widget: "string",
                                    },
                                    {
                                        label: "Images",
                                        name: "images",
                                        widget: "list",
                                        fields:
                                            [
                                                {
                                                    label: "Image",
                                                    name: "image",
                                                    widget: "image",
                                                },
                                                {
                                                    label: "Caption",
                                                    name: "caption",
                                                    widget: "string",
                                                },
                                            ],
                                    },
                                ],
                        },
                    ],
            }
          - {
                label: "Protocols",
                name: "protocols",
                widget: "list",
                required: false,
                collapsed: true,
                fields:
                    - { label: "File Upload", name: "file", widget: "file",   required: false },
                    - { label: "File Name",   name: "file_name", widget: "string", required: false },
                    - { label: "Category",    name: "category", widget: "select", options: *options_protocolCategory, required: false }
            }
    - name: "gene-name"
      label: "Gene and structures names"
      folder: "src/pages/gene-names"
      slug: "{{symbol}}"
      create: true # Allow users to create new documents in this collection
      fields: # The fields each document in this collection have
          - <<: *field_templateKey
            default: "gene-name"
          - {
                label: "Gene Symbol",
                name: "symbol",
                widget: "string",
                required: true,
            }
          - {
                label: "Gene Name",
                name: "name",
                widget: "string",
                required: true,
            }
          - {
                label: "Protein",
                name: "protein",
                widget: "string",
                required: false,
            }
          - {
                label: "Structure",
                name: "structure",
                widget: "string",
                required: false,
            }
          - label: "Isoforms"
            name: "isoforms"
            widget: "list"
            required: false
            fields:
                - { label: "Gene name", name: "name", widget: "string" }
                - { label: "Isoforms", name: "ids", widget: "list" }
    - name: "disease"
      label: "Modeled diseases"
      folder: "src/pages/diseases"
      slug: "{{name}}"
      create: true # Allow users to create new documents in this collection
      fields: # The fields each document in this collection have
          - <<: *field_templateKey
            default: "disease"
          - { label: "Name", name: "name", widget: string }
          - <<: *relation_gene
          - {
                label: "Status",
                name: "status",
                widget: "select",
                options: ["Coming soon", "Available"],
                default: "Coming soon",
                required: true,
            }
    - name: "pages"
      label: "Pages"
      files:
          - file: "src/pages/index.md"
            label: "Cell Line Catalog"
            name: "normal-catalog"
            fields:
                - <<: *field_templateKey
                  default: "normal-catalog"
                - { label: "Title", name: "title", widget: "string" }
                - {
                      label: "About Block",
                      name: "about_block",
                      widget: "object",
                      fields
                        - <<: *objects_richTextObject,
                          label: "Primary Text",
                          name: "primary",
                        - <<: *objects_richTextObject,
                          label: "Disease Catalog Copy",
                          name: "disease"
                  }
                - { label: "Body", name: "body", widget: "markdown" }
                - {
                    label: "Main",
                    name: "main",
                    widget: "object",
                    fields:
                        [
                            {
                                label: "Heading",
                                name: "heading",
                                widget: "string",
                            },
                            {
                                label: "Subheading",
                                name: "subheading",
                                required: false,
                                widget: "string",
                            },
                            {
                                label: "Description",
                                name: "description",
                                widget: "markdown",
                            },
                        ],
                }
                - {
                    label: "Coriell Image",
                    name: "coriell_image",
                    widget: "image",
                }
                - {
                    label: "Coriell Link",
                    name: "coriell_link",
                    widget: "string",
                }
                - {
                    label: "Acknowledgements Block",
                    name: "acknowledgements_block",
                    widget: "object",
                    fields: *acknowledgementsBlock
                }
                - { label: "Funding", name: "funding_text", widget: "markdown" }
